[pytest]
# ----------------------------------------------------------
# Author: Nandan Kumar
# Date: 10/18/2025
# Project: IS601_Midterm - Enhanced Calculator
# ----------------------------------------------------------
# Purpose:
# Centralized Pytest configuration for consistent test discovery,
# reliable coverage reporting, and safe non-blocking execution.
#
# This configuration ensures:
#   - All tests run quietly with coverage tracking
#   - REPL/infinite-loop tests timeout automatically
#   - Clear, timestamped logging for debugging
#   - Compatibility with GitHub Actions and local runs
# ----------------------------------------------------------

# ----------------------------------------------------------
# Test Discovery Settings
# ----------------------------------------------------------
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# ----------------------------------------------------------
# Default Pytest Options
# ----------------------------------------------------------
addopts =
    --cov=app
    --cov-report=term-missing
    --cov-report=html
    --maxfail=1
    --disable-warnings
    -q
    --tb=short

# ----------------------------------------------------------
# Timeout Handling
# ----------------------------------------------------------
# Prevents long-running REPL or infinite-loop issues
timeout = 5
timeout_method = thread
timeout_func_only = true
faulthandler_timeout = 10

# ----------------------------------------------------------
# Custom Markers
# ----------------------------------------------------------
markers =
    slow: marks tests as slow (run selectively with -m slow)
    fast: marks tests as fast (default group)
    repl: marks REPL-related integration tests

# ----------------------------------------------------------
# Logging Configuration
# ----------------------------------------------------------
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)s] %(message)s
log_cli_date_format = %H:%M:%S

# ----------------------------------------------------------
# Coverage Settings (for consistency across CI tools)
# ----------------------------------------------------------
# Show missing lines, but skip standard library and virtualenv
filterwarnings =
    ignore::DeprecationWarning
